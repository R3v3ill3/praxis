import{b as S,j as s,d as C,u as T,r as i,R,k,f as M,h as D,i as E}from"./index-D6efte17.js";function P(){const{user:n}=S();if(!n)return s.jsx("div",{className:"p-4 text-center text-gray-600",children:"Loading your profileâ€¦"});const b=n.uid;console.log("[CampaignBuilder] currentUser:",n);const{updateCampaignData:w}=C(),j=T(),[u,d]=i.useState([]),[r,m]=i.useState(""),[c,p]=i.useState(!1),[g,h]=i.useState(""),l=R.useRef(null),x=async()=>{if(!r.trim())return;const e={role:"user",content:r.trim()},o=[...u,e];d(o),p(!0),h("");try{const a=await(await fetch("/api/campaign-assistant",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:r.trim(),history:o})})).json(),v={role:"assistant",content:a.aiMessage};if(d(t=>[...t,v]),setTimeout(()=>{var t;return(t=l.current)==null?void 0:t.scrollTo(0,l.current.scrollHeight)},100),a.done&&a.structured){const t=await fetch("/api/classify-campaign-type",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({summary:a})}),{match:N}=await t.json(),y={userId:b,summary:a,classification:N,createdAt:k()};await M(D(E,"campaigns",n.uid),y),w(y),j("/campaign/next-steps")}}catch(f){console.error("Error:",f),h("Something went wrong. Please try again.")}finally{m(""),p(!1)}};return s.jsxs("div",{className:"p-4 max-w-3xl mx-auto",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Describe Your Campaign"}),s.jsx("div",{className:"border rounded p-4 mb-4 bg-gray-50 max-h-[50vh] overflow-y-auto",ref:l,children:u.map((e,o)=>s.jsx("div",{className:`mb-2 ${e.role==="user"?"text-right":"text-left"}`,children:s.jsx("span",{className:`inline-block px-4 py-2 rounded-lg shadow max-w-[80%] ${e.role==="user"?"bg-blue-500 text-white":"bg-gray-200 text-black"}`,children:e.content})},o))}),s.jsx("textarea",{rows:3,className:"w-full border rounded p-2 mb-2",placeholder:"Type your message...",value:r,onChange:e=>m(e.target.value),onKeyDown:e=>{e.key==="Enter"&&!e.shiftKey&&(e.preventDefault(),x())},disabled:c}),s.jsx("button",{onClick:x,className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700",disabled:c,children:c?"Thinking...":"Send"}),g&&s.jsx("p",{className:"mt-2 text-red-600",children:g})]})}export{P as default};
//# sourceMappingURL=CampaignBuilder-YSCHIWP5.js.map
