import{b as U,u as k,r as t,j as s,h as M,i as D,l as F}from"./index-D6efte17.js";function R(){const{user:u}=U(),v=k(),[m,j]=t.useState(null),[c,S]=t.useState(null),[l,N]=t.useState([]),[r,w]=t.useState([]),[d,_]=t.useState([]),[y,h]=t.useState(""),[p,b]=t.useState(""),[x,g]=t.useState("");t.useEffect(()=>{const e=localStorage.getItem("campaignData");if(e){const o=JSON.parse(e);j(o),S(o.classification||{})}},[]),t.useEffect(()=>{fetch("/api/classification-options").then(e=>e.json()).then(e=>{N(e.types||[]),w(e.subtypes||[]),_(e.useCases||[])}).catch(e=>console.error("❌ Failed to load classification options:",e))},[]),t.useEffect(()=>{if(!c||l.length===0||r.length===0||d.length===0)return;const e=l.find(n=>{var a;return n.name.toLowerCase()===((a=c.primary_type)==null?void 0:a.toLowerCase())}),o=r.find(n=>{var a;return n.name.toLowerCase()===((a=c.secondary_type)==null?void 0:a.toLowerCase())}),f=d.find(n=>{var a;return n.name.toLowerCase()===((a=c.sub_type)==null?void 0:a.toLowerCase())});e&&h(e.id),o&&b(o.id),f&&g(f.id)},[l,r,d,c]);const E=async()=>{var n,a,C;if(!(u!=null&&u.uid)||!(m!=null&&m.campaignId))return;const e=((n=l.find(i=>i.id===y))==null?void 0:n.name)||"",o=((a=r.find(i=>i.id===p))==null?void 0:a.name)||"",f=((C=d.find(i=>i.id===x))==null?void 0:C.name)||"";try{const i=M(D,"users",u.uid,"campaigns",m.campaignId);await F(i,{classification:{primary_type:e,secondary_type:o,sub_type:f}}),console.log("✅ Classification updated in Firestore"),v("/campaign/next-steps")}catch(i){console.error("❌ Error saving classification:",i)}},I=r.filter(e=>e.type_id===y),L=p==null?void 0:p.split("_").pop(),T=d.filter(e=>e.subtype_id===L);return s.jsxs("div",{className:"max-w-xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Review and Update Campaign Classification"}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Primary Type"}),s.jsxs("select",{className:"w-full border border-gray-300 rounded p-2",value:y,onChange:e=>h(e.target.value),children:[s.jsx("option",{value:"",children:"Select primary type"}),l.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Secondary Type"}),s.jsxs("select",{className:"w-full border border-gray-300 rounded p-2",value:p,onChange:e=>b(e.target.value),children:[s.jsx("option",{value:"",children:"Select secondary type"}),I.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Use Case"}),s.jsxs("select",{className:"w-full border border-gray-300 rounded p-2",value:x,onChange:e=>g(e.target.value),children:[s.jsx("option",{value:"",children:"Select use case"}),T.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]})]}),s.jsx("button",{onClick:E,className:"bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700",children:"Save Classification"})]})}export{R as default};
//# sourceMappingURL=EditCampaignClassification-C317NpJA.js.map
