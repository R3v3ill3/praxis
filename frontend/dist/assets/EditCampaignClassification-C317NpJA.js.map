{"version":3,"file":"EditCampaignClassification-C317NpJA.js","sources":["../../src/pages/EditCampaignClassification.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport { doc, updateDoc } from 'firebase/firestore';\nimport { db } from '../firebase';\nimport { useNavigate } from 'react-router-dom';\n\nexport default function EditCampaignClassification() {\n  const { user } = useAuth();\n  const navigate = useNavigate();\n\n  const [campaignData, setCampaignData] = useState(null);\n  const [classification, setClassification] = useState(null);\n  const [types, setTypes] = useState([]);\n  const [subtypes, setSubtypes] = useState([]);\n  const [useCases, setUseCases] = useState([]);\n\n  const [primaryTypeId, setPrimaryTypeId] = useState('');\n  const [secondaryTypeId, setSecondaryTypeId] = useState('');\n  const [useCaseId, setUseCaseId] = useState('');\n\n  useEffect(() => {\n    const storedCampaign = localStorage.getItem('campaignData');\n    if (storedCampaign) {\n      const parsed = JSON.parse(storedCampaign);\n      setCampaignData(parsed);\n      setClassification(parsed.classification || {});\n    }\n  }, []);\n\n  useEffect(() => {\n    fetch('/api/classification-options')\n      .then(res => res.json())\n      .then(data => {\n        setTypes(data.types || []);\n        setSubtypes(data.subtypes || []);\n        setUseCases(data.useCases || []);\n      })\n      .catch(err => console.error('❌ Failed to load classification options:', err));\n  }, []);\n\n  useEffect(() => {\n    if (!classification || types.length === 0 || subtypes.length === 0 || useCases.length === 0) return;\n\n    const typeMatch = types.find(t => t.name.toLowerCase() === classification.primary_type?.toLowerCase());\n    const subtypeMatch = subtypes.find(s => s.name.toLowerCase() === classification.secondary_type?.toLowerCase());\n    const useCaseMatch = useCases.find(u => u.name.toLowerCase() === classification.sub_type?.toLowerCase());\n\n    if (typeMatch) setPrimaryTypeId(typeMatch.id);\n    if (subtypeMatch) setSecondaryTypeId(subtypeMatch.id);\n    if (useCaseMatch) setUseCaseId(useCaseMatch.id);\n  }, [types, subtypes, useCases, classification]);\n\n  const handleSave = async () => {\n    if (!user?.uid || !campaignData?.campaignId) return;\n\n    const typeName = types.find(t => t.id === primaryTypeId)?.name || '';\n    const subtypeName = subtypes.find(s => s.id === secondaryTypeId)?.name || '';\n    const useCaseName = useCases.find(u => u.id === useCaseId)?.name || '';\n\n    try {\n      const ref = doc(db, 'users', user.uid, 'campaigns', campaignData.campaignId);\n      await updateDoc(ref, {\n        classification: {\n          primary_type: typeName,\n          secondary_type: subtypeName,\n          sub_type: useCaseName\n        }\n      });\n      console.log('✅ Classification updated in Firestore');\n      navigate('/campaign/next-steps');\n    } catch (err) {\n      console.error('❌ Error saving classification:', err);\n    }\n  };\n\n  const filteredSubtypes = subtypes.filter(s => s.type_id === primaryTypeId);\n  const subtypeCore = secondaryTypeId?.split('_').pop();\n  const filteredUseCases = useCases.filter(u => u.subtype_id === subtypeCore);\n\n  return (\n    <div className=\"max-w-xl mx-auto p-6 bg-white rounded-lg shadow-md\">\n      <h2 className=\"text-2xl font-bold mb-4\">Review and Update Campaign Classification</h2>\n\n      <div className=\"mb-4\">\n        <label className=\"block text-sm font-medium mb-1\">Primary Type</label>\n        <select\n          className=\"w-full border border-gray-300 rounded p-2\"\n          value={primaryTypeId}\n          onChange={e => setPrimaryTypeId(e.target.value)}\n        >\n          <option value=\"\">Select primary type</option>\n          {types.map(t => (\n            <option key={t.id} value={t.id}>{t.name}</option>\n          ))}\n        </select>\n      </div>\n\n      <div className=\"mb-4\">\n        <label className=\"block text-sm font-medium mb-1\">Secondary Type</label>\n        <select\n          className=\"w-full border border-gray-300 rounded p-2\"\n          value={secondaryTypeId}\n          onChange={e => setSecondaryTypeId(e.target.value)}\n        >\n          <option value=\"\">Select secondary type</option>\n          {filteredSubtypes.map(s => (\n            <option key={s.id} value={s.id}>{s.name}</option>\n          ))}\n        </select>\n      </div>\n\n      <div className=\"mb-6\">\n        <label className=\"block text-sm font-medium mb-1\">Use Case</label>\n        <select\n          className=\"w-full border border-gray-300 rounded p-2\"\n          value={useCaseId}\n          onChange={e => setUseCaseId(e.target.value)}\n        >\n          <option value=\"\">Select use case</option>\n          {filteredUseCases.map(u => (\n            <option key={u.id} value={u.id}>{u.name}</option>\n          ))}\n        </select>\n      </div>\n\n      <button\n        onClick={handleSave}\n        className=\"bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700\"\n      >\n        Save Classification\n      </button>\n    </div>\n  );\n}\n"],"names":["EditCampaignClassification","user","useAuth","navigate","useNavigate","campaignData","setCampaignData","useState","classification","setClassification","types","setTypes","subtypes","setSubtypes","useCases","setUseCases","primaryTypeId","setPrimaryTypeId","secondaryTypeId","setSecondaryTypeId","useCaseId","setUseCaseId","useEffect","storedCampaign","parsed","res","data","err","typeMatch","t","_a","subtypeMatch","s","useCaseMatch","u","handleSave","typeName","subtypeName","_b","useCaseName","_c","ref","doc","db","updateDoc","filteredSubtypes","subtypeCore","filteredUseCases","jsxs","jsx"],"mappings":"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"}